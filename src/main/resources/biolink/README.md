# Biolink mappings

CAM-KP needs Biolink information in both the triplestore backend as well as the 
frontend. This is frustrating -- if only one of them needed to know about the
Biolink model, that would greatly simplify what we need to do here.

We previously generated `predicates.csv` and `mkg-nodes.csv` from the
[CAM Pipeline](https://github.com/ExposuresProvider/cam-pipeline) and incorporated
them in here (via the parent directory). This was relatively easy to do when
Biolink predicates could be mapped directly to relations in the triplestore, but
since Biolink 3 includes predicates modified with qualifiers, this mapping is more
complicated.

This directory takes all of our predicate mapping logic and puts it into one place:
the [`predicates.json`](./predicates.json) file in this directory is intended to provide
the definitive set of mappings between Biolink predicate/qualifier combinations and
triplestore relations. A single relation may be mapped to several predicate/qualifier
combinations and vice versa.

Two pieces of code interact with this file:
1. `org.renci.cam.util.GenerateBiolinkPredicateMappings` is a standalone program that
   can be used to regenerate this file. It currently uses the
   [Biolink predicate_mapping.yaml](https://github.com/biolink/biolink-model/blob/master/predicate_mapping.yaml),
   mapping information from the triplestore and a list of manual mappings added during
   development, but in the future it may be expanded to include additional files.
2. `org.renci.cam.domain.PredicateMappings` is a module in the code that provides a
   programmatic interface to the contents of the `predicates.json` file, and provides
   methods to map from Biolink predicate/qualifier combinations to relations.

The `predicates.json` file can be regenerated by updating the
Biolink version in application.conf and then running:

```shell
$ SPARQL_ENDPOINT=https://cam-kp-sparql-dev.apps.renci.org/sparql sbt "runMain org.renci.cam.util.GenerateBiolinkPredicateMappings"
```

The latest `predicates.json` file should be checked into the GitHub repository so that
changes to it can be tracked.